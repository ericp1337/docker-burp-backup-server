---

- name: Copy uthash.h to /usr/include
  copy:
    src: uthash.h
    dest: /usr/include/uthash.h

- name: Download Burp Server
  git:
    depth: 1
    repo: "https://github.com/grke/burp.git"
    version: "{{ BURP_VERSION }}"
    dest: /tmp/burp

- shell: ./configure --sysconfdir=/defaults --localstatedir=/data && make && make install
  args:
    chdir: /tmp/burp

- file: path="{{ item }}" state=directory mode=0700
  with_items:
    - /etc/burp
    - /data

- lineinfile: dest=/defaults/burp-server.conf state=present regexp="^directory =" line="directory = /data"

- lineinfile: dest=/defaults/burp-server.conf state=present regexp="^stdout =" line="stdout = 1"

- action: setup
